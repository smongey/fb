"use strict";var gulp=require("gulp"),$=require("gulp-load-plugins")(),browserSync=require("browser-sync"),reload=browserSync.reload;gulp.task("styles",function(){return gulp.src("app/styles/main.scss").pipe($.sourcemaps.init()).pipe($.sass({outputStyle:"nested",precision:10,includePaths:["."],onError:console.error.bind(console,"Sass error:")})).pipe($.postcss([require("autoprefixer-core")({browsers:["last 1 version"]})])).pipe($.sourcemaps.write()).pipe(gulp.dest(".tmp/styles")).pipe(reload({stream:!0}))}),gulp.task("fileinclude",function(){return gulp.src("app/*.html").pipe($.fileInclude()).pipe($.size()).pipe(gulp.dest(".tmp"))}),gulp.task("jshint",function(){return gulp.src("app/scripts/**/*.js").pipe(reload({stream:!0,once:!0})).pipe($.jshint()).pipe($.jshint.reporter("jshint-stylish")).pipe($["if"](!browserSync.active,$.jshint.reporter("fail")))}),gulp.task("html",["styles"],function(){var e=$.useref.assets({searchPath:[".tmp","app","."]});return gulp.src("app/*.html").pipe($.fileInclude()).pipe(e).pipe($["if"]("*.js",$.uglify())).pipe($["if"]("*.css",$.csso())).pipe(e.restore()).pipe($.useref()).pipe(gulp.dest("dist"))}),gulp.task("images",function(){return gulp.src("app/images/**/*").pipe($.cache($.imagemin({progressive:!0,interlaced:!0,svgoPlugins:[{cleanupIDs:!1}]}))).pipe(gulp.dest("dist/images"))}),gulp.task("fonts",function(){return gulp.src(require("main-bower-files")({filter:"**/*.{eot,svg,ttf,woff,woff2}"}).concat("app/fonts/**/*")).pipe(gulp.dest(".tmp/fonts")).pipe(gulp.dest("dist/fonts"))}),gulp.task("extras",function(){return gulp.src(["app/*.*","!app/*.html"],{dot:!0}).pipe(gulp.dest("dist"))}),gulp.task("clean",require("del").bind(null,[".tmp","dist"])),gulp.task("serve",["styles","fileinclude","fonts"],function(){browserSync({notify:!1,port:9e3,server:{baseDir:[".tmp","app"],routes:{"/bower_components":"bower_components"}}}),gulp.watch(["app/*.html","app/**/*.html","app/scripts/**/*.js","app/images/**/*",".tmp/fonts/**/*"]).on("change",reload),gulp.watch("app/styles/**/*.scss",["styles"]),gulp.watch("app/fonts/**/*",["fonts"]),gulp.watch(["app/*.html","app/**/*.html"],["fileinclude"]),gulp.watch("bower.json",["wiredep","fonts"])}),gulp.task("wiredep",function(){var e=require("wiredep").stream;gulp.src("app/styles/*.scss").pipe(e({ignorePath:/^(\.\.\/)+/})).pipe(gulp.dest("app/styles")),gulp.src("app/*.html").pipe(e({ignorePath:/^(\.\.\/)*\.\./})).pipe(gulp.dest("app"))}),gulp.task("build",["html","images","fonts","fileinclude","extras"],function(){return gulp.src("dist/**/*").pipe($.size({title:"build",gzip:!0}))}),gulp.task("default",["clean"],function(){gulp.start("build")});